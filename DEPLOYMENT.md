# ğŸš€ Supabase ç¾å®¹é™¢é¢„çº¦ç³»ç»Ÿ - å®Œæ•´éƒ¨ç½²æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¾å®¹é™¢é¢„çº¦ç®¡ç†ç³»ç»Ÿï¼Œå·²æˆåŠŸé›†æˆ Supabase ä½œä¸ºåç«¯æœåŠ¡ã€‚é¡¹ç›®åŒ…å«ç”¨æˆ·è®¤è¯ã€æœåŠ¡ç®¡ç†ã€é¢„çº¦ç³»ç»Ÿç­‰å®Œæ•´åŠŸèƒ½ã€‚

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### ğŸ” ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- âœ… é‚®ç®±å¯†ç æ³¨å†Œ/ç™»å½•
- âœ… è‡ªåŠ¨ä¼šè¯ç®¡ç†
- âœ… å—ä¿æŠ¤çš„è·¯ç”±
- âœ… ç”¨æˆ·çŠ¶æ€æŒä¹…åŒ–

### ğŸ›ï¸ æœåŠ¡ç®¡ç†
- âœ… ä» Supabase æ•°æ®åº“è·å–æœåŠ¡åˆ—è¡¨
- âœ… æœåŠ¡è¯¦æƒ…å±•ç¤º
- âœ… å“åº”å¼æœåŠ¡å¡ç‰‡è®¾è®¡
- âœ… åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†

### ğŸ“… é¢„çº¦ç³»ç»Ÿ
- âœ… æ—¥æœŸå’Œæ—¶é—´é€‰æ‹©å™¨
- âœ… é¢„çº¦ç¡®è®¤é¡µé¢
- âœ… åˆ›å»ºé¢„çº¦åˆ° Supabase
- âœ… æˆ‘çš„é¢„çº¦é¡µé¢
- âœ… å–æ¶ˆé¢„çº¦åŠŸèƒ½
- âœ… é¢„çº¦çŠ¶æ€ç®¡ç†

### ğŸ¨ ç”¨æˆ·ç•Œé¢
- âœ… ç°ä»£åŒ–å“åº”å¼è®¾è®¡
- âœ… Tailwind CSS æ ·å¼ç³»ç»Ÿ
- âœ… åŠ è½½åŠ¨ç”»å’ŒçŠ¶æ€åé¦ˆ
- âœ… ç§»åŠ¨ç«¯é€‚é…

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

å·²åˆ›å»ºå®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„ï¼š

```sql
-- æœåŠ¡è¡¨
services (
  id UUID PRIMARY KEY,
  name VARCHAR(100),
  description TEXT,
  duration_minutes INTEGER,
  price DECIMAL(10,2),
  image_url TEXT,
  is_active BOOLEAN,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)

-- é¢„çº¦è¡¨
bookings (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  service_id UUID REFERENCES services(id),
  booking_date DATE,
  booking_time TIME,
  status VARCHAR(20),
  notes TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)

-- ç”¨æˆ·èµ„æ–™è¡¨
user_profiles (
  id UUID REFERENCES auth.users(id),
  name VARCHAR(100),
  phone VARCHAR(20),
  avatar_url TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)
```

## ğŸ”§ æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Next.js 15.5.3 + React 19.1.1
- **æ ·å¼ç³»ç»Ÿ**: Tailwind CSS 3.4.17
- **åç«¯æœåŠ¡**: Supabase (æ•°æ®åº“ + è®¤è¯)
- **çŠ¶æ€ç®¡ç†**: React Context API
- **HTTP å®¢æˆ·ç«¯**: Supabase JS SDK

## ğŸ“¦ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
xiangmu/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ auth/                 # è®¤è¯ç»„ä»¶
â”‚   â”œâ”€â”€ booking/              # é¢„çº¦ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ common/               # é€šç”¨ç»„ä»¶
â”‚   â””â”€â”€ layout/               # å¸ƒå±€ç»„ä»¶
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useAuth.js           # âœ… Supabase è®¤è¯é›†æˆ
â”‚   â”œâ”€â”€ useBookings.js       # âœ… é¢„çº¦ç®¡ç†
â”‚   â”œâ”€â”€ useServices.js       # âœ… æœåŠ¡ç®¡ç†
â”‚   â””â”€â”€ useLocalStorage.js   # æœ¬åœ°å­˜å‚¨å·¥å…·
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase.js          # âœ… Supabase å®¢æˆ·ç«¯é…ç½®
â”‚   â””â”€â”€ supabase-server.js   # âœ… æœåŠ¡ç«¯é…ç½®
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ booking/
â”‚   â”‚   â””â”€â”€ confirm.js       # âœ… é¢„çº¦ç¡®è®¤é¡µ
â”‚   â”œâ”€â”€ index.js             # âœ… é¦–é¡µé‡å®šå‘
â”‚   â”œâ”€â”€ services.js          # âœ… æœåŠ¡åˆ—è¡¨é¡µ
â”‚   â”œâ”€â”€ booking.js           # âœ… é¢„çº¦æ—¶é—´é€‰æ‹©
â”‚   â”œâ”€â”€ login.js             # âœ… ç™»å½•é¡µ
â”‚   â”œâ”€â”€ register.js          # âœ… æ³¨å†Œé¡µ
â”‚   â””â”€â”€ my-bookings.js       # âœ… æˆ‘çš„é¢„çº¦é¡µ
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ init-database.sql    # âœ… æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ database.js          # âœ… æ•°æ®åº“æ“ä½œå‡½æ•°
â”œâ”€â”€ .env.local.example       # âœ… ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ README.md                # âœ… é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ README-SUPABASE.md       # âœ… Supabase è¯¦ç»†æŒ‡å—
â””â”€â”€ DEPLOYMENT.md            # âœ… éƒ¨ç½²æŒ‡å—
```

## ğŸš€ å¿«é€Ÿéƒ¨ç½²æ­¥éª¤

### 1. åˆ›å»º Supabase é¡¹ç›®

1. è®¿é—® [Supabase](https://supabase.com)
2. ç‚¹å‡» "New Project"
3. é€‰æ‹©ç»„ç»‡å¹¶å¡«å†™é¡¹ç›®ä¿¡æ¯
4. ç­‰å¾…é¡¹ç›®åˆ›å»ºå®Œæˆ

### 2. è·å–é¡¹ç›®é…ç½®

åœ¨ Supabase é¡¹ç›®ä»ªè¡¨æ¿ï¼š
1. è¿›å…¥ `Settings` â†’ `API`
2. å¤åˆ¶ä»¥ä¸‹ä¿¡æ¯ï¼š
   - `Project URL`
   - `anon public` key

### 3. é…ç½®ç¯å¢ƒå˜é‡

å°† `.env.local.example` å¤åˆ¶ä¸º `.env.local`ï¼š
```bash
cp .env.local.example .env.local
```

ç¼–è¾‘ `.env.local` æ–‡ä»¶ï¼š
```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

1. åœ¨ Supabase ä»ªè¡¨æ¿ï¼Œè¿›å…¥ `SQL Editor`
2. å¤åˆ¶ `scripts/init-database.sql` çš„å®Œæ•´å†…å®¹
3. ç²˜è´´å¹¶æ‰§è¡Œ SQL è„šæœ¬
4. ç¡®è®¤æ‰€æœ‰è¡¨å’Œç­–ç•¥åˆ›å»ºæˆåŠŸ

### 5. é…ç½®è®¤è¯è®¾ç½®

åœ¨ Supabase ä»ªè¡¨æ¿ï¼š
1. è¿›å…¥ `Authentication` â†’ `Settings`
2. åœ¨ `Site URL` ä¸­è®¾ç½®ï¼š`http://localhost:3000`
3. åœ¨ `Redirect URLs` ä¸­æ·»åŠ ï¼š`http://localhost:3000`

### 6. å¯åŠ¨é¡¹ç›®

```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000)

## ğŸ§ª æµ‹è¯•åŠŸèƒ½

### æµ‹è¯•ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
1. è®¿é—® `/register` æ³¨å†Œæ–°ç”¨æˆ·
2. æ£€æŸ¥é‚®ç®±éªŒè¯ï¼ˆå¦‚æœå¯ç”¨ï¼‰
3. ä½¿ç”¨ `/login` ç™»å½•

### æµ‹è¯•é¢„çº¦æµç¨‹
1. è®¿é—® `/services` æŸ¥çœ‹æœåŠ¡åˆ—è¡¨
2. é€‰æ‹©æœåŠ¡è¿›å…¥é¢„çº¦æµç¨‹
3. é€‰æ‹©æ—¥æœŸå’Œæ—¶é—´
4. ç¡®è®¤é¢„çº¦
5. åœ¨ `/my-bookings` æŸ¥çœ‹é¢„çº¦è®°å½•

### éªŒè¯æ•°æ®åº“
åœ¨ Supabase ä»ªè¡¨æ¿çš„ `Table Editor` ä¸­æ£€æŸ¥ï¼š
- `services` è¡¨æœ‰ç¤ºä¾‹æ•°æ®
- `bookings` è¡¨è®°å½•ç”¨æˆ·é¢„çº¦
- `user_profiles` è¡¨è‡ªåŠ¨åˆ›å»ºç”¨æˆ·èµ„æ–™

## ğŸŒ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### Vercel éƒ¨ç½²
1. å°†ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ Vercel å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. æ›´æ–° Supabase çš„ Site URL ä¸ºç”Ÿäº§åŸŸå

### ç¯å¢ƒå˜é‡é…ç½®
```env
NEXT_PUBLIC_SUPABASE_URL=your_production_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_production_supabase_anon_key
```

## ğŸ”’ å®‰å…¨é…ç½®

### è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS)
å·²é…ç½®å®Œæ•´çš„ RLS ç­–ç•¥ï¼š
- ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„é¢„çº¦
- æ‰€æœ‰ç”¨æˆ·å¯ä»¥æŸ¥çœ‹æœåŠ¡ä¿¡æ¯
- è‡ªåŠ¨ç”¨æˆ·èµ„æ–™åˆ›å»º

### è®¤è¯å®‰å…¨
- ä½¿ç”¨ Supabase Auth çš„å®‰å…¨è®¤è¯
- JWT token è‡ªåŠ¨ç®¡ç†
- ä¼šè¯çŠ¶æ€æŒä¹…åŒ–

## ğŸ“Š åŠŸèƒ½æ¼”ç¤º

### ä¸»è¦é¡µé¢æˆªå›¾ä½ç½®
- æœåŠ¡åˆ—è¡¨é¡µï¼š`/services`
- é¢„çº¦æµç¨‹ï¼š`/booking?serviceId=xxx`
- é¢„çº¦ç¡®è®¤ï¼š`/booking/confirm`
- æˆ‘çš„é¢„çº¦ï¼š`/my-bookings`
- ç”¨æˆ·è®¤è¯ï¼š`/login`, `/register`

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: æ„å»ºæ—¶å‡ºç° "supabaseUrl is required" é”™è¯¯**
A: ç¡®ä¿ `.env.local` æ–‡ä»¶å­˜åœ¨ä¸”é…ç½®æ­£ç¡®

**Q: ç”¨æˆ·æ³¨å†Œåæ— æ³•ç™»å½•**
A: æ£€æŸ¥ Supabase é‚®ç®±éªŒè¯è®¾ç½®

**Q: é¢„çº¦åˆ›å»ºå¤±è´¥**
A: æ£€æŸ¥ RLS ç­–ç•¥å’Œç”¨æˆ·è®¤è¯çŠ¶æ€

**Q: æœåŠ¡åˆ—è¡¨ä¸ºç©º**
A: ç¡®ä¿æ‰§è¡Œäº†æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

### è°ƒè¯•æŠ€å·§
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. æŸ¥çœ‹ Supabase ä»ªè¡¨æ¿æ—¥å¿—
3. éªŒè¯ç¯å¢ƒå˜é‡é…ç½®
4. ç¡®è®¤æ•°æ®åº“è¡¨ç»“æ„

## ğŸ“ˆ åç»­æ‰©å±•

### å¯æ·»åŠ åŠŸèƒ½
- ç®¡ç†å‘˜åå°
- æœåŠ¡åˆ†ç±»ç®¡ç†
- é¢„çº¦æé†’é€šçŸ¥
- æ”¯ä»˜é›†æˆ
- è¯„ä»·ç³»ç»Ÿ
- å¤šè¯­è¨€æ”¯æŒ

### æ€§èƒ½ä¼˜åŒ–
- å›¾ç‰‡ä¼˜åŒ–å’Œ CDN
- æ•°æ®ç¼“å­˜ç­–ç•¥
- ä»£ç åˆ†å‰²
- SEO ä¼˜åŒ–

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **Supabase æ–‡æ¡£**: https://supabase.com/docs
- **Next.js æ–‡æ¡£**: https://nextjs.org/docs
- **Tailwind CSS**: https://tailwindcss.com/docs

---

**é¡¹ç›®çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª  
**æœ€åæ›´æ–°**: 2024å¹´1æœˆ  
**å¼€å‘è€…**: CodeBuddy